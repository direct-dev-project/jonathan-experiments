<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Direct.dev Sync Dashboard</title>
  <link rel="stylesheet" href="styles.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js" defer></script>
  <script src="app.js" defer></script>
</head>
<body>
  <div class="app">
    <header class="hero">
      <div>
        <p class="eyebrow">Direct.dev</p>
        <h1>E2E Sync Dashboard</h1>
        <p class="subtitle">Tracking drift, latency, batch requests, and memory.</p>
      </div>
      <div class="status" id="statusBadge">Live</div>
    </header>

    <!-- Core Metrics -->
    <section class="metrics">
      <div class="metric-card">
        <p class="metric-label">Success Rate</p>
        <div class="metric-value" id="successRate">--</div>
        <p class="metric-sub" id="passFail">--</p>
      </div>
      <div class="metric-card">
        <p class="metric-label">Drift (mean / p90)</p>
        <div class="metric-value" id="driftSummary">--</div>
        <p class="metric-sub" id="driftRange">--</p>
      </div>
      <div class="metric-card">
        <p class="metric-label">Latency Speedup</p>
        <div class="metric-value" id="speedupRatio">--</div>
        <p class="metric-sub" id="latencySummary">--</p>
      </div>
    </section>

    <!-- Batch Metrics -->
    <section class="metrics">
      <div class="metric-card">
        <p class="metric-label">Batch Ordered</p>
        <div class="metric-value" id="batchOrdered">--</div>
        <p class="metric-sub">Response ordering correct</p>
      </div>
      <div class="metric-card">
        <p class="metric-label">Batch Match</p>
        <div class="metric-value" id="batchMatch">--</div>
        <p class="metric-sub">Results match reference</p>
      </div>
      <div class="metric-card">
        <p class="metric-label">Batch Speedup</p>
        <div class="metric-value" id="batchSpeedup">--</div>
        <p class="metric-sub" id="batchLatency">vs sequential</p>
      </div>
    </section>

    <!-- Memory & Errors -->
    <section class="metrics">
      <div class="metric-card">
        <p class="metric-label">Heap Memory</p>
        <div class="metric-value" id="heapMemory">--</div>
        <p class="metric-sub" id="memoryTrend">--</p>
      </div>
      <div class="metric-card">
        <p class="metric-label">Direct Errors</p>
        <div class="metric-value" id="directErrors">--</div>
        <p class="metric-sub">Failed responses</p>
      </div>
      <div class="metric-card">
        <p class="metric-label">Ref Errors</p>
        <div class="metric-value" id="refErrors">--</div>
        <p class="metric-sub">Reference failures</p>
      </div>
    </section>

    <!-- Mismatches -->
    <section class="metrics">
      <div class="metric-card">
        <p class="metric-label">Mismatches</p>
        <div class="metric-value" id="totalMismatches">--</div>
        <p class="metric-sub">Values differ</p>
      </div>
      <div class="metric-card">
        <p class="metric-label">Recovered</p>
        <div class="metric-value" id="recoveredMismatches">--</div>
        <p class="metric-sub">Ref hiccups</p>
      </div>
      <div class="metric-card">
        <p class="metric-label">Persistent</p>
        <div class="metric-value" id="persistentMismatches">--</div>
        <p class="metric-sub">Potential bugs</p>
      </div>
    </section>

    <!-- Charts -->
    <section class="charts">
      <div class="panel">
        <div class="panel-header"><h2>Drift Over Time</h2></div>
        <canvas id="driftChart"></canvas>
      </div>
      <div class="panel">
        <div class="panel-header"><h2>Latency Comparison</h2></div>
        <canvas id="latencyChart"></canvas>
      </div>
    </section>

    <section class="charts">
      <div class="panel">
        <div class="panel-header"><h2>Memory Usage</h2></div>
        <canvas id="memoryChart"></canvas>
      </div>
      <div class="panel">
        <div class="panel-header"><h2>Batch Latency</h2></div>
        <canvas id="batchChart"></canvas>
      </div>
    </section>

    <!-- Tables -->
    <section class="table-panel">
      <div class="panel-header"><h2>Recent Samples</h2></div>
      <div class="table-wrapper">
        <table>
          <thead><tr><th>Time</th><th>Drift</th><th>Direct (ms)</th><th>Ref (ms)</th><th>Batch</th><th>Heap (MB)</th></tr></thead>
          <tbody id="dataTable"></tbody>
        </table>
      </div>
    </section>

    <footer><span id="lastUpdated">Loading...</span> | <span id="totalSamples">0</span> samples</footer>
  </div>
</body>
</html>
